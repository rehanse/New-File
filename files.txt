it('should process excel data and merge records when matching record is found', () => {
    // Arrange: Sample input data
    const jsonData = [{ 
        locationName: 'USA', 
        locationAddress: '1 Park Avenue', 
        city: 'New York', 
        state: 'New York', 
        country: 'United States',
        ULId: null
    }];
    
    const propertyValueData = [{
        ULId: '12345',
        PropertyLocationId: '1',
        LocationName: 'USA',
        Address: '1 Park Avenue',
        City: 'New York',
        StateProvince: 'New York',
        Country: 'United States',
        BuildingValue: '5000'
    }];

    // ✅ Mock `findMatchingRecordKey` to always return a key
    spyOn(component, 'findMatchingRecordKey').and.returnValue('existingKey');

    // ✅ Mock `mapRowToPropertyValueExcelFile` to return a valid object
    spyOn(MapperUtil, 'mapRowToPropertyValueExcelFile').and.returnValue({
        ULId: '12345',
        LocationName: 'USA',
        Address: '1 Park Avenue',
        City: 'New York',
        StateProvince: 'New York',
        Country: 'United States',
        BuildingValue: '5000'
    });

    // ✅ Spy on `mergeValues`
    spyOn(component, 'mergeValues').and.callThrough();

    // Act
    component.processExcelData(jsonData, propertyValueData);

    // Assert: Ensure `findMatchingRecordKey` was called
    expect(component.findMatchingRecordKey).toHaveBeenCalledWith(
        jasmine.any(Object),
        'USA',
        'United States'
    );

    // Assert: Ensure `mergeValues` was called with a valid `propertyValue`
    expect(component.mergeValues).toHaveBeenCalledWith(
        jasmine.any(Object), // mergedRecords
        'existingKey',       // Matching record key
        jasmine.objectContaining({ BuildingValue: '5000' })  // Ensuring valid property value
    );
});
