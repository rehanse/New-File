it('should process excel data and merge records when matching record is found', () => {
    // Arrange: Sample input data with properly structured row[]
    const jsonData = [{ 
        locationName: 'USA', 
        locationAddress: '1 Park Avenue', 
        city: 'New York', 
        state: 'New York', 
        country: 'United States',
        ULId: null
    }];
    
    const propertyValueData = [[
        "12345",     // ULId
        "1",         // PropertyLocationId
        "USA",       // LocationName
        "1 Park Avenue", // Address
        "New York",  // City
        "New York",  // StateProvince
        "United States", // Country
        "5000"       // BuildingValue
    ]];

    spyOn(component, 'findMatchingRecordKey').and.returnValue('existingKey');
    spyOn(component, 'mergeValues').and.callThrough();

    // Act
    component.processExcelData(jsonData, propertyValueData);

    // Ensure `findMatchingRecordKey` was called
    expect(component.findMatchingRecordKey).toHaveBeenCalledWith(
        jasmine.any(Object),
        'USA',
        'United States'
    );

    // Ensure `mergeValues` was called
    expect(component.mergeValues).toHaveBeenCalledWith(
        jasmine.any(Object), // mergedRecords
        'existingKey',       // Matching record key
        jasmine.objectContaining({ BuildingValue: 5000 })  // Ensuring valid property value
    );
});
